- [项目变更前](#项目变更前)
- [项目变更中](#项目变更中)
- [项目变更后](#项目变更后)


[参考链接](https://mp.weixin.qq.com/s/z_qQ2UcoWoqqEVolEk-38w)

# 项目变更前

1. 使用`TS`（静态类型能力）
2. `静态扫描`，例如`ESlint`工具。有些公司也会定期去扫描代码仓库，检查有风险代码，比如容易造成 XSS 攻击的 dangerouslySetInnerHTML 等等。
3. 三方依赖：比较好的策略是，**项目中依赖不锁，由中间商保证依赖版本**。
4. `标准化`：将通用的解决方案标准化，比如图片怎么引入、国际化怎么写、CSS 解决方案、请求解决方案、API 格式 等等。
5. `单元测试`
6. `变更卡点`：在非本地环境要加上检查卡点，检查内容包括不限于 ESLint 等静态代码检查、测试用例是否通过、测试覆盖率、构建产物的大小等等。

   **卡点阶段**可以是在代码合并之前，部署之前，迭代阶段推进之前，发布之前等，需要根据不同的卡点内容选择合适的阶段。
7. `Code Review`

# 项目变更中

1. `灰度`：将新版本逐步放量，让部分用户先来使用新版本。
2. `应急`：
   1. 新的变更最好可以添加**开关控制**。比如本次变更新增了一块功能，我们可以在数据库新增一个 isShow 的标识，如果这个功能出问题，我们可以立即修改数据库，下线该功能。
   2. 迭代之间的**回滚**能力一定要具备，对于开关控制满足不了的，要能立即回滚到上一个迭代。
3. `监控`：
   - 标准的前端监控应该包括以下数据：
     - JS 异常
     - Promise 异常
     - 资源异常
     - API 请求
     - 页面整体访问情况，包括 PV、UV
     - 页面性能情况
     - 其它核心业务自定义数据
   - 一个优秀的监控系统，需要考虑以下几个方面：
     - 数据上报要够方便，最好接入一个 SDK 之后，一行代     码都不用写，必要的数据自动上报。比如 JS 异常、资源异常、PV、性能数据、API 请求等等都是可以在最外层拦截到的。
     - 上报的数据要够全，比如当前 URL 、浏览器信息、用户位置等等。
     - 支持自定义数据上报。
     - 数据大盘要够直观，可以直观的看到各种趋势变化。
     - 支持多版本上报，比如灰度的 1% 用户的数据变化，要和其它 99% 用户的区分开。
     - 支持采样率
     - JS 异常可以快速定位，要支持 sourcemap 绑定，同样这里要考虑 sourcemap 什么时候上传，如何和当前的研发流程融合。
     - 支持单个用户纬度上报数据时间线查看，在碰到问题时可以更方便的分析上下文。
     - 自身的稳定性要好，不能影响宿主系统的性能和稳定性。
4. `报警`：方便及时发现线上故障。注意，报警配置一定要做好降噪，否则等出现真正线上问题的时候就没人关心了。

# 项目变更后

1. `巡检`：指通过脚本，定时去检查线上应用是否正常工作。

